{% extends "base.html" %}
{% set bafs_is_live = true %}
{% block head %}
<style>
.section{
	padding-bottom:2em;
}
.really-big{
	font-size: 2em;
}
.pretty-big{
	font-size: 1.8em;
}
.really-big span{
	white-space: normal;
}
.responsiveCal {
position: relative; padding-bottom: 75%; height: 0; overflow: hidden;
}
.responsiveCal iframe {
position: absolute; top:0; left: 0; width: 100%; height: 100%;
}
.mini-img {
	border-radius: .5rem;
	max-width: 100%;
	max-height: 12rem;
	margin-bottom: .5rem;
}
</style>
{% endblock %}
{% block beforenav %}
{% for photo in photos %}
  <div class="modal fade pop-up-{{photo.id}}" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">

        <div class="modal-header">
          <h4 class="modal-title text-truncate" id="myLargeModalLabel-1">{{photo.caption|default(photo.ride.name, true)}}</h4>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body d-flex flex-column ekko-lightbox-container">
        <img src="{{photo.img_l}}" class="img-responsive center-block" alt="{{photo.caption}}">
		</div>
		<div class="modal-footer">
        	Taken by <a href="/people/{{ photo.ride.athlete.id }}">{{ photo.ride.athlete.display_name }}</a>.  {% if photo.ref %}<a href='{{photo.ref}}'>View in Instagram</a>{% endif %}
		</div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal mixer image -->
{% endfor %}
{% endblock %}
{% block content %}
<div id="sect-main" class="card mb-3 mb-lg-5 mt-lg-4 bg-light">
	<div class="p-4 p-lg-5 d-flex flex-column flex-lg-row align-items-center">
		<img src="/img/logo-blue-sm.png" class="me-lg-5" />
		<div class="d-flex flex-column align-items-center align-items-lg-start text-center text-lg-start">
			<h1 style="font-size: 4rem;">Freezing Saddles</h1>
			<h3>Ride bike. Earn points.</h3>
			<p class="text-muted">
				The official leaderboard and data analysis charts for the {{ competition_title }}
				competition.
			</p>
			<div class="btn-group mb-2" role="group" aria-label="Team Points">
				<a href="/leaderboard/team" class="btn btn-primary">Official Points Leaderboard</a>
				<a href="/leaderboard/team_text" class="btn btn-primary">Official Points Leaderboard (text)</a>
			</div>
		</div>
	</div>
</div>
{% if not bafs_is_live %}
<div id="sect-cal" class="row section">
	<div class="col-md-12">
		<h3>The shiny new Freezing Saddles competition for the upcoming winter hasn't started yet, but there are still bike rides going on. You should go for a bike ride.</h3>
		<div class="responsiveCal">
<iframe src="https://calendar.google.com/calendar/embed?height=600&amp;wkst=1&amp;bgcolor=%23FFFFFF&amp;src=vss0aloebi85u9dc9shihueg0o%40group.calendar.google.com&amp;color=%2342104A&amp;ctz=America%2FNew_York" style="border-width:0" width="800" height="600" frameborder="0" scrolling="no"></iframe>
 </div>
</div>
</div>
{% endif %}

<div id="sect-stats" class="row section">
	<div class="col-md-12">
		<p class="really-big"><span class="badge bg-secondary">{{team_count}} teams.  {{contestant_count}} contestants.</span></p>

	    <p class="really-big"><span class="badge bg-secondary">{{total_rides|groupnum}} rides.  {{total_hours|groupnum}} hours.  {{total_miles|groupnum}} miles ridden.</span>
	    </p>

	    <p class="pretty-big">
			<span class="badge bg-primary">{{sub_freezing_hours|groupnum}} hours below freezing.</span>
	        <span class="badge bg-success">{{rain_hours|groupnum}} hours in the rain.</span>
	        <span class="badge bg-info">{{snow_hours|groupnum}} hours in the snow.</span>
		</p>
	</div>
</div>
<div id="sect-photos" class="row section">
	<div class="col-md-12">
		<div class="row">
			{% for photo in photos %}
				<div class="col-lg-2 col-md-3 col-xs-4 text-center">
					<a href="#" class="photo-parent" data-bs-toggle="modal" data-bs-target=".pop-up-{{photo.id}}">
						<div class="center-cropped"
							style="background-image: url('{{ photo.img_l }}');">
							<img src="https://placehold.it/120x120"/>
						</div>
					</a>
					<p class="mt-1">Taken by <a href="/people/{{ photo.ride.athlete.id }}">{{ photo.ride.athlete.display_name }}</a></p>
				</div>
	    	{% endfor %}
			<div class="col-lg-2 col-md-3 col-xs-4 text-center">
				<a href="{{ url_for('photos.index') }}" class="btn btn-primary btn-lg d-flex align-items-center" style="width: 10rem; height: 10rem">More Photos</a>
			</div>
		</div>
	</div>
</div>

{% if bafs_is_live %}
<div id="sect-cal" class="row section">
	<div class="col-md-6">
		<div class="responsiveCal">
		<iframe src="https://calendar.google.com/calendar/embed?height=400&amp;wkst=1&amp;bgcolor=%23FFFFFF&amp;src=vss0aloebi85u9dc9shihueg0o%40group.calendar.google.com&amp;color=%2342104A&amp;ctz=America%2FNew_York" style="border-width:0" width="800" height="400" frameborder="0" scrolling="no"></iframe></div>
	</div>
	<div class="col-md-6">
        &nbsp;
        <!-- placeholder for real-time graph of rides submitted.
             See https://github.com/freezingsaddles/freezing-web/issues/178
        -->
	</div>
</div>
{% endif %}

</div>
{% endblock %}
